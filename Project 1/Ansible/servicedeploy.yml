---
  - hosts: local
    sudo: yes
    tasks:
      # Git glone the repository onto the blog machine
      - name: grab the blog files from the git repository
        command: git clone https://github.com/CSUN-SeniorDesign/eat-blog.git
        
      # Download and install Hugo
      - name: download and install hugo
        command: snap install hugo

      # Use Hugo to create a site
      - name: create site using hugo
        command: hugo new site beats

      # Clone the git repo that holds the "dream" theme
      - name: clone git repo for hugo theme
        command: git clone https://github.com/g1eny0ung/hugo-theme-dream.git
        
      # Copy files
      - name: move files from dream to beats
        command: mv $HOME/hugo-theme-dream $HOME/beats/themes/

      # Copy post files
      - name: copy post files
        command: cd $HOME/eat-blog && mv * $HOME/beats/content/post

      # Edit config file for hugo
      - name: config file edit
        command: echo "baseURL = \"https://fa480.club\"" > config.toml

      - name: config file edit
        command: echo "languageCode = \"en-us\"" >> config.toml

      - name: config file edit
        command: echo "title = \"CIT 480 beats blog\"" >> config.toml

      - name: config file edit
        command: echo "theme = \"hugo-theme-dream\"" >> config.toml

      # Run hugo 
      - name: create site using hugo command
        command: hugo

      # Move files from /public to /var/www/html
      - name: move pubic files to apache's html folder
        command: cd $HOME/beats/public && mv * /var/www/html
